"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[8288],{3582:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>s,contentTitle:()=>d,default:()=>u,frontMatter:()=>a,metadata:()=>t,toc:()=>r});const t=JSON.parse('{"id":"getting-started/advanced-deployment-options/cuda","title":"Install CUDA on Linux","description":"If you are using an Nvidia-enabled VM instance from a public cloud, you should probably use the VM image provided by the cloud. It typically has the correct versions of Nvidia driver and CUDA toolkit already installed.","source":"@site/docs/getting-started/advanced-deployment-options/cuda.md","sourceDirName":"getting-started/advanced-deployment-options","slug":"/getting-started/advanced-deployment-options/cuda","permalink":"/getting-started/advanced-deployment-options/cuda","draft":false,"unlisted":false,"editUrl":"https://github.com/GaiaNet-AI/docs/edit/main/docs/getting-started/advanced-deployment-options/cuda.md","tags":[],"version":"current","sidebarPosition":101,"frontMatter":{"sidebar_position":101},"sidebar":"tutorialSidebar","previous":{"title":"Start a node on AWS using AMI images","permalink":"/getting-started/advanced-deployment-options/aws"},"next":{"title":"Install multiple nodes on a single machine","permalink":"/getting-started/advanced-deployment-options/multiple"}}');var o=i(4848),l=i(8453);const a={sidebar_position:101},d="Install CUDA on Linux",s={},r=[{value:"Ubuntu 22.04",id:"ubuntu-2204",level:2},{value:"1 Install the Nvidia driver.",id:"1-install-the-nvidia-driver",level:3},{value:"2 Install the CUDA toolkit.",id:"2-install-the-cuda-toolkit",level:3},{value:"More resources",id:"more-resources",level:2}];function c(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,l.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.header,{children:(0,o.jsx)(n.h1,{id:"install-cuda-on-linux",children:"Install CUDA on Linux"})}),"\n",(0,o.jsx)(n.p,{children:"If you are using an Nvidia-enabled VM instance from a public cloud, you should probably use the VM image provided by the cloud. It typically has the correct versions of Nvidia driver and CUDA toolkit already installed.\nRead on if you need to install Nvidia driver and CUDA toolkit on your own machine."}),"\n",(0,o.jsx)(n.h2,{id:"ubuntu-2204",children:"Ubuntu 22.04"}),"\n",(0,o.jsx)(n.h3,{id:"1-install-the-nvidia-driver",children:"1 Install the Nvidia driver."}),"\n",(0,o.jsx)(n.p,{children:"Rebuild the grub configuration:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:'sudo apt-get install -y gcc make linux-headers-$(uname -r)\ncat << EOF | sudo tee --append /etc/modprobe.d/blacklist.conf\nblacklist vga16fb\nblacklist nouveau\nblacklist rivafb\nblacklist nvidiafb\nblacklist rivatv\nEOF\nsudo sed -i \'s/GRUB_CMDLINE_LINUX=""/GRUB_CMDLINE_LINUX="rdblacklist=nouveau"/\' /etc/default/grub\nsudo update-grub\n'})}),"\n",(0,o.jsx)(n.p,{children:"Download and install the Nvidia driver"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"wget https://storage.googleapis.com/nvidia-drivers-us-public/GRID/vGPU16.1/NVIDIA-Linux-x86_64-535.104.05-grid.run\nsudo sh NVIDIA-Linux-x86_64-535.104.05-grid.run\n"})}),"\n",(0,o.jsx)(n.p,{children:"Confirm the driver is installed successfully"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"nvidia-smi -q | head\n\n==============NVSMI LOG==============\n\nTimestamp                                 : Fri Oct 27 21:54:05 2023\nDriver Version                            : 535.104.05\nCUDA Version                              : 12.2\n\nAttached GPUs                             : 1\nGPU 00000000:00:1E.0\n    Product Name                          : NVIDIA A10G\n"})}),"\n",(0,o.jsx)(n.p,{children:"Disable GSP and reboot."}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:'sudo touch /etc/modprobe.d/nvidia.conf\necho "options nvidia NVreg_EnableGpuFirmware=0" | sudo tee --append /etc/modprobe.d/nvidia.conf\nsudo reboot\n'})}),"\n",(0,o.jsx)(n.h3,{id:"2-install-the-cuda-toolkit",children:"2 Install the CUDA toolkit."}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"wget https://developer.download.nvidia.com/compute/cuda/12.2.2/local_installers/cuda_12.2.2_535.104.05_linux.run\nsudo sh cuda_12.2.2_535.104.05_linux.run --silent --override --toolkit --samples --toolkitpath=/usr/local/cuda-12 --samplespath=/usr/local/cuda --no-opengl-libs\n"})}),"\n",(0,o.jsx)(n.p,{children:"Confirm that CUDA is installed."}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"/usr/local/cuda/bin/nvcc --version\n\nnvcc: NVIDIA (R) Cuda compiler driver\nCopyright (c) 2005-2023 NVIDIA Corporation\nBuilt on Tue_Aug_15_22:02:13_PDT_2023\nCuda compilation tools, release 12.2, V12.2.140\nBuild cuda_12.2.r12.2/compiler.33191640_0\n"})}),"\n",(0,o.jsxs)(n.p,{children:["After that, use the following two commands to set up the environment path. You should probably add these two lines to your ",(0,o.jsx)(n.code,{children:"~/.bashrc"})," and ",(0,o.jsx)(n.code,{children:"~/.bash_profile"})," (or ",(0,o.jsx)(n.code,{children:"~/.zshrc"})," and ",(0,o.jsx)(n.code,{children:"~/.profile"}),") files so that new terminals and future logins will still be able to find these CUDA library files."]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"export LD_LIBRARY_PATH=/usr/local/cuda/lib64:${LD_LIBRARY_PATH}\nexport PATH=/usr/local/cuda/bin:${PATH}\n"})}),"\n",(0,o.jsx)(n.h2,{id:"more-resources",children:"More resources"}),"\n",(0,o.jsx)(n.p,{children:"Here are more scripts that could help you in case you are stuck."}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["The ",(0,o.jsx)(n.a,{href:"https://docs.nvidia.com/cuda/cuda-installation-guide-linux/",children:"Nvidia official install guide"})," for Linux."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.a,{href:"https://x.com/yampeleg/status/1751823896800583924",children:"Yam Peleg's popular script"})," for Ubuntu 22.04"]}),"\n",(0,o.jsx)(n.li,{children:(0,o.jsx)(n.a,{href:"https://docs.nvidia.com/datacenter/cloud-native/container-toolkit/latest/install-guide.html",children:"Make CUDA available in Docker containers"})}),"\n"]})]})}function u(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(c,{...e})}):c(e)}},8453:(e,n,i)=>{i.d(n,{R:()=>a,x:()=>d});var t=i(6540);const o={},l=t.createContext(o);function a(e){const n=t.useContext(l);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:a(e.components),t.createElement(l.Provider,{value:n},e.children)}}}]);