"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[3550],{3696:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>a,default:()=>h,frontMatter:()=>r,metadata:()=>o,toc:()=>d});const o=JSON.parse('{"id":"tutorial/concepts","title":"Gaia nodes with long-term knowledge","description":"The LLM app requires both long-term and short-term memories. Long-term memory includes factual knowledge, historical facts, background stories etc. They are best added to the context as complete chapters instead of small chunks of text to maintain the internal consistency of the knowledge.","source":"@site/docs/tutorial/concepts.md","sourceDirName":"tutorial","slug":"/tutorial/concepts","permalink":"/tutorial/concepts","draft":false,"unlisted":false,"editUrl":"https://github.com/GaiaNet-AI/docs/edit/main/docs/tutorial/concepts.md","tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"sidebar_position":1},"sidebar":"tutorialSidebar","previous":{"title":"\ud83d\udcda Guides & Tutorials","permalink":"/guides-and-tutorials"},"next":{"title":"Calling external tools","permalink":"/tutorial/tool-call"}}');var i=n(4848),s=n(8453);const r={sidebar_position:1},a="Gaia nodes with long-term knowledge",l={},d=[{value:"Workflow for creating knowledge embeddings",id:"workflow-for-creating-knowledge-embeddings",level:2},{value:"Lifecycle of a user query on a knowledge-supplemented LLM",id:"lifecycle-of-a-user-query-on-a-knowledge-supplemented-llm",level:2},{value:"Ask a question",id:"ask-a-question",level:3},{value:"Retrieve similar embeddings",id:"retrieve-similar-embeddings",level:3},{value:"Response to the user query",id:"response-to-the-user-query",level:3}];function c(e){const t={a:"a",blockquote:"blockquote",h1:"h1",h2:"h2",h3:"h3",header:"header",img:"img",li:"li",ol:"ol",p:"p",ul:"ul",...(0,s.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(t.header,{children:(0,i.jsx)(t.h1,{id:"gaia-nodes-with-long-term-knowledge",children:"Gaia nodes with long-term knowledge"})}),"\n",(0,i.jsx)(t.p,{children:"The LLM app requires both long-term and short-term memories. Long-term memory includes factual knowledge, historical facts, background stories etc. They are best added to the context as complete chapters instead of small chunks of text to maintain the internal consistency of the knowledge."}),"\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.a,{href:"https://blogs.nvidia.com/blog/what-is-retrieval-augmented-generation/",children:"RAG"}),"\nis an important technique to inject contextual knowledge into an LLM application. It improves accuracy and reduces the hallucination of LLMs.\nAn effective RAG application combines real-time and user-specific short-term memory (chunks) with stable long-term memory (chapters) in the prompt context."]}),"\n",(0,i.jsx)(t.p,{children:'Since the application\'s long-term memory is stable (even immutable), we package it in a vector database tightly coupled with the LLM. The client app assembles the short-term memory in the prompt and is supplemented with the long-term memory on the LLM server. We call the approach "server-side RAG".'}),"\n",(0,i.jsxs)(t.blockquote,{children:["\n",(0,i.jsx)(t.p,{children:"The long context length supported by modern LLMs are especially well-suited for long-term knowledge that are best represented by chapters of text."}),"\n"]}),"\n",(0,i.jsx)(t.p,{children:"A Gaia node is an OpenAI compatible LLM service that is grounded by long-term knowledge on the server side. The client application can simply chat with it or provide realtime / short-term memory since the LLM is already aware of the domain or background."}),"\n",(0,i.jsxs)(t.blockquote,{children:["\n",(0,i.jsx)(t.p,{children:"For example, if you ask ChatGPT the question What is Layer 2, the answer is that Layer 2 is a concept from the computer network. However, if you ask a blockchain person, they answer that Layer 2 is a way to scale the original Ethereum network. That's the difference between a generic LLM and knowledge-supplemented LLMs."}),"\n"]}),"\n",(0,i.jsxs)(t.p,{children:["We will cover the external knowledge preparation and how a knowledge-supplemented LLM completes a conversation. If you have learned how a RAG application works, go to ",(0,i.jsx)(t.a,{href:"../knowledge-bases/web-tool",children:"Build a RAG application with Gaia"})," to start building one."]}),"\n",(0,i.jsxs)(t.ol,{children:["\n",(0,i.jsx)(t.li,{children:"Create embeddings for your own knowledge as the long-term memory."}),"\n",(0,i.jsx)(t.li,{children:"Lifecycle of a user query on a knowledge-supplemented LLM."}),"\n"]}),"\n",(0,i.jsx)(t.p,{children:"For this solution, we will use"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsx)(t.li,{children:"a chat model like Llama-3-8B for generating responses to the user."}),"\n",(0,i.jsxs)(t.li,{children:["a text embedding model like ",(0,i.jsx)(t.a,{href:"https://huggingface.co/second-state/Nomic-embed-text-v1.5-Embedding-GGUF",children:"nomic-embed-text"})," for creating and retrieving embeddings."]}),"\n",(0,i.jsx)(t.li,{children:"a Vector DB like Qdrant for storing embeddings."}),"\n"]}),"\n",(0,i.jsx)(t.h2,{id:"workflow-for-creating-knowledge-embeddings",children:"Workflow for creating knowledge embeddings"}),"\n",(0,i.jsx)(t.p,{children:"The first step is to create embeddings for our knowledge base and store the embeddings in a vector DB."}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{src:"https://github.com/GaiaNet-AI/docs/assets/45785633/2ff40178-64f4-4e2e-bbd9-f12ce35186b7",alt:"create-embedding"})}),"\n",(0,i.jsx)(t.p,{children:"First of all, we split the long text into sections (i.e, chunks). All LLMs have a maximum context length. The model can't read the context if the text is too long.\nThe most used rule for a Gaia node is to put the content in one chapter together. Remember, insert a blank line between two chunks. You can also use other algorithms to chunk your text."}),"\n",(0,i.jsx)(t.p,{children:"After chunking the document, we can convert these chunks into embeddings leveraging the embedding model. The embedding model is trained to create embeddings based on text and search for similar embeddings. We will use the latter function in the process of user query."}),"\n",(0,i.jsx)(t.p,{children:"Additionally, we will need a vector DB to store the embeddings so that we can retrieve these embeddings quickly at any time."}),"\n",(0,i.jsxs)(t.p,{children:["On a Gaia node, we will get a database snapshot with the embeddings to use at last. Check out how to create your embeddings using ",(0,i.jsx)(t.a,{href:"../knowledge-bases/web-tool",children:"Gaia web tool"}),", ",(0,i.jsx)(t.a,{href:"../knowledge-bases/how-to/text",children:"from a plain text file"}),", and ",(0,i.jsx)(t.a,{href:"../knowledge-bases/how-to/markdown",children:"from a markdown file"}),"."]}),"\n",(0,i.jsx)(t.h2,{id:"lifecycle-of-a-user-query-on-a-knowledge-supplemented-llm",children:"Lifecycle of a user query on a knowledge-supplemented LLM"}),"\n",(0,i.jsxs)(t.p,{children:["Next, let's learn the lifecycle of a user query on a knowledge-supplemented LLM. We will take ",(0,i.jsx)(t.a,{href:"https://knowledge.gaianet.network/chatbot-ui/index.html",children:"a Gaia Node with Gaia knowledge"})," as an example."]}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{src:"https://github.com/GaiaNet-AI/docs/assets/45785633/c64b85ea-65f0-43d2-8ab3-78889d21c248",alt:"user-query-rag"})}),"\n",(0,i.jsx)(t.h3,{id:"ask-a-question",children:"Ask a question"}),"\n",(0,i.jsx)(t.p,{children:"when you send a question in human language to the node, the embedding model will first convert your question to embedding."}),"\n",(0,i.jsx)(t.h3,{id:"retrieve-similar-embeddings",children:"Retrieve similar embeddings"}),"\n",(0,i.jsx)(t.p,{children:"Then, the embedding model will search all the embeddings stored in the Qdrant vector DB and retrieve the embeddings that are similar to the question embeddings."}),"\n",(0,i.jsx)(t.h3,{id:"response-to-the-user-query",children:"Response to the user query"}),"\n",(0,i.jsx)(t.p,{children:"The embedding node will return the retrieved embeddings to the chat model. The chat model will use the retrieved embeddings plus your input questions as context to answer your queries finally."})]})}function h(e={}){const{wrapper:t}={...(0,s.R)(),...e.components};return t?(0,i.jsx)(t,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}},8453:(e,t,n)=>{n.d(t,{R:()=>r,x:()=>a});var o=n(6540);const i={},s=o.createContext(i);function r(e){const t=o.useContext(s);return o.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function a(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:r(e.components),o.createElement(s.Provider,{value:t},e.children)}}}]);