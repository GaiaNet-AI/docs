"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[4537],{1658:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>a,contentTitle:()=>l,default:()=>h,frontMatter:()=>s,metadata:()=>o,toc:()=>d});const o=JSON.parse('{"id":"getting-started/troubleshooting","title":"Troubleshooting","description":"The system cannot find CUDA libraries","source":"@site/docs/getting-started/troubleshooting.md","sourceDirName":"getting-started","slug":"/getting-started/troubleshooting","permalink":"/getting-started/troubleshooting","draft":false,"unlisted":false,"editUrl":"https://github.com/GaiaNet-AI/docs/edit/main/docs/getting-started/troubleshooting.md","tags":[],"version":"current","sidebarPosition":6,"frontMatter":{"sidebar_position":6},"sidebar":"tutorialSidebar","previous":{"title":"Joining the Gaia Protocol","permalink":"/getting-started/register"},"next":{"title":"Install or Uninstall the CLI","permalink":"/getting-started/install"}}');var t=i(4848),r=i(8453);const s={sidebar_position:6},l="Troubleshooting",a={},d=[{value:"The system cannot find CUDA libraries",id:"the-system-cannot-find-cuda-libraries",level:2},{value:"Failed to recover from collection snapshot on Windows WSL",id:"failed-to-recover-from-collection-snapshot-on-windows-wsl",level:2},{value:"Failed to start the node with an error message <code>Port 8080 is in use. Exit ...</code>",id:"failed-to-start-the-node-with-an-error-message-port-8080-is-in-use-exit-",level:2},{value:"Load library failed: libgomp.so.1: cannot open shared object file: No such file or directory",id:"load-library-failed-libgompso1-cannot-open-shared-object-file-no-such-file-or-directory",level:2},{value:"Failed to remove the default collection",id:"failed-to-remove-the-default-collection",level:2},{value:"File I/O error",id:"file-io-error",level:2},{value:"The &quot;Failed to open the file&quot; Error",id:"the-failed-to-open-the-file-error",level:2},{value:"The &quot;Too many open files&quot; Error on macOS",id:"the-too-many-open-files-error-on-macos",level:2},{value:"Permission denied when use the installer script to install WasmEdge",id:"permission-denied-when-use-the-installer-script-to-install-wasmedge",level:2}];function c(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",...(0,r.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"troubleshooting",children:"Troubleshooting"})}),"\n",(0,t.jsx)(n.h2,{id:"the-system-cannot-find-cuda-libraries",children:"The system cannot find CUDA libraries"}),"\n",(0,t.jsxs)(n.p,{children:["Sometimes, the CUDA toolkit is installed in a non-standard location. The error message here is often not able to find ",(0,t.jsx)(n.code,{children:"libcu*12"}),". For example, you might have CUDA installed with your Python setup. The following command would install CUDA into Python's environment."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"sudo apt install python3-pip -y\npip3 install --upgrade fschat accelerate autoawq vllm\n"})}),"\n",(0,t.jsx)(n.p,{children:"The easiest way to fix is simply to link those non-standard CUDA libraries to the standard location, like this."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"ln -s /usr/local/lib/python3.10/dist-packages/nvidia/cublas/lib/libcublas.so.12 /usr/lib/libcublas.so.12\nln -s /usr/local/lib/python3.10/dist-packages/nvidia/cuda_runtime/lib/libcudart.so.12 /usr/lib/libcudart.so.12\nln -s /usr/local/lib/python3.10/dist-packages/nvidia/cublas/lib/libcublasLt.so.12 /usr/lib/libcublasLt.so.12\n"})}),"\n",(0,t.jsx)(n.h2,{id:"failed-to-recover-from-collection-snapshot-on-windows-wsl",children:"Failed to recover from collection snapshot on Windows WSL"}),"\n",(0,t.jsxs)(n.p,{children:["On Windows WSL, you could see this error while running ",(0,t.jsx)(n.code,{children:"gaianet init"}),"."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:'   * Import the Qdrant collection snapshot ...\n      The process may take a few minutes. Please wait ...\n    * [Error] Failed to recover from the collection snapshot. {"status":{"error":"Service internal error: Tokio task join error: task 1242 panicked"},"time":0.697784244}\n'})}),"\n",(0,t.jsxs)(n.p,{children:["When you look into the ",(0,t.jsx)(n.code,{children:"~/gaianet/log/init-qdrant.log"})," file, you could see this line of error"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:'2024-05-20T07:24:52.900895Z ERROR qdrant::startup: Panic occurred in file /home/runner/.cargo/registry/src/index.crates.io-6f17d22bba15001f/cgroups-rs-0.3.4/src/memory.rs at line 587: called `Result::unwrap()` on an `Err` value: Error { kind: ReadFailed("/sys/fs/cgroup/memory.high"), cause: Some(Os { code: 2, kind: NotFound, message: "No such file or directory" }) }  \n'})}),"\n",(0,t.jsxs)(n.p,{children:["The solution is to disable the ",(0,t.jsx)(n.code,{children:"autoMemoryReclaim"})," feature in WSL. Step to turn on/off this feature:"]}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["Edit ",(0,t.jsx)(n.code,{children:"C:\\Users<Your user name>.wslconfig"})]}),"\n",(0,t.jsxs)(n.li,{children:["Remove or comment out ",(0,t.jsx)(n.code,{children:"autoMemoryReclaim"})," in ",(0,t.jsx)(n.code,{children:"[experimental]"})," section."]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{src:i(9019).A+"",width:"1290",height:"444"})}),"\n",(0,t.jsxs)(n.p,{children:["Thanks to ",(0,t.jsx)(n.a,{href:"https://github.com/RoggeOhta",children:"RoggeOhta"})," for discovering this. You can learn more about it ",(0,t.jsx)(n.a,{href:"https://github.com/GaiaNet-AI/gaianet-node/issues/46",children:"here"}),"."]}),"\n",(0,t.jsxs)(n.h2,{id:"failed-to-start-the-node-with-an-error-message-port-8080-is-in-use-exit-",children:["Failed to start the node with an error message ",(0,t.jsx)(n.code,{children:"Port 8080 is in use. Exit ..."})]}),"\n",(0,t.jsxs)(n.p,{children:["You may see the following error when you run ",(0,t.jsx)(n.code,{children:"gaianet start"}),"."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"gaianet start\n[+] Checking the config.json file ...\n\nYou already have a private key.\n[+] Starting LlamaEdge API Server ...\n\n    Port 8080 is in use. Exit ...\n"})}),"\n",(0,t.jsxs)(n.p,{children:["The solution is to run ",(0,t.jsx)(n.code,{children:"gaianet stop"}),"  first to kill all processes, and then run ",(0,t.jsx)(n.code,{children:"gaianet start"})," to start the node."]}),"\n",(0,t.jsx)(n.h2,{id:"load-library-failed-libgompso1-cannot-open-shared-object-file-no-such-file-or-directory",children:"Load library failed: libgomp.so.1: cannot open shared object file: No such file or directory"}),"\n",(0,t.jsxs)(n.p,{children:["On Windows WSL, you may see this error when running ",(0,t.jsx)(n.code,{children:"curl -sSfL 'https://github.com/GaiaNet-AI/gaianet-node/releases/latest/download/install.sh' | bash"})]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"* Generate node IS\n[2024-07-02 17:50:55.175] [error] loading failed: invalid path, Code: 0x20\n[2024-07-02 17:50:55.175] [error]   Load library failed: libgomp.so.1: cannot open shared object file: No such file or directory\n[2024-07-02 17:50:55.176] [error] loading failed: invalid path, Code: 0x20\n[2024-07-02 17:50:55.176] [error]   Load library failed: libgomp.so.1: cannot open shared object file: No such file or directory\n"})}),"\n",(0,t.jsxs)(n.p,{children:["The error is caused by the lack of ",(0,t.jsx)(n.code,{children:"libgomp.so.1"}),", a library that should be automatically installed on Ubuntu by default."]}),"\n",(0,t.jsxs)(n.p,{children:["To solve this, you must install the ",(0,t.jsx)(n.code,{children:"libgomp.so.1"})," library."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"sudo apt-get update\nsudo apt-get install libgomp1\n"})}),"\n",(0,t.jsx)(n.p,{children:"If you're using CentOS, you can use"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"yum install libgomp\n"})}),"\n",(0,t.jsxs)(n.p,{children:["This issue was fixed in ",(0,t.jsx)(n.code,{children:"version 0.2.2"}),"."]}),"\n",(0,t.jsx)(n.h2,{id:"failed-to-remove-the-default-collection",children:"Failed to remove the default collection"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:'Failed to remove the default collection. {"status":{"error":"Service internal error: No such file or directory (os error 2)"},"time":0.050924542}\n'})}),"\n",(0,t.jsx)(n.p,{children:"It typically indicates that the Qdrant instance was not shut down properly before you try to init it again with a new snapshot. The solution is to stop the GaiaNet node first."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"gaianet stop\n"})}),"\n",(0,t.jsx)(n.p,{children:"Alternatively, you could manually kill the processes from the terminal or in the OS's Activity Monitor."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"sudo pkill -9 qdrant\nsudo pkill -9 wasmedge\nsudo pkill -9 frpc\n"})}),"\n",(0,t.jsxs)(n.p,{children:["Then you can run ",(0,t.jsx)(n.code,{children:"gaianet init"})," and then ",(0,t.jsx)(n.code,{children:"gaianet start"})," again."]}),"\n",(0,t.jsx)(n.h2,{id:"file-io-error",children:"File I/O error"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"    * Import the Qdrant collection snapshot ...\n      The process may take a few minutes. Please wait ...\n    * [Error] Failed to recover from the collection snapshot. An error occurred processing field `snapshot`: File I/O error: Operation not permitted (os error 1) \n"})}),"\n",(0,t.jsx)(n.p,{children:"It typically indicates that the Qdrant instance was not shut down properly before you try to init it again with a new snapshot. The solution is to stop the GaiaNet node first."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"gaianet stop\n"})}),"\n",(0,t.jsx)(n.p,{children:"Alternatively, you could manually kill the processes from the terminal or in the OS's Activity Monitor."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"sudo pkill -9 qdrant\nsudo pkill -9 wasmedge\nsudo pkill -9 frpc\n"})}),"\n",(0,t.jsxs)(n.p,{children:["Then you can run ",(0,t.jsx)(n.code,{children:"gaianet init"})," and then ",(0,t.jsx)(n.code,{children:"gaianet start"})," again."]}),"\n",(0,t.jsx)(n.h2,{id:"the-failed-to-open-the-file-error",children:'The "Failed to open the file" Error'}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"Warning: Failed to open the file \nWarning: https://huggingface.co/datasets/max-id/gaianet-qdrant-snapshot/resolve\nWarning: /main/consensus/consensus.snapshot: No such file or directory\ncurl: (23) Failure writing output to destination\n"})}),"\n",(0,t.jsxs)(n.p,{children:["The reason for this type of error is a mis-configured ",(0,t.jsx)(n.code,{children:"config.json"})," file. The solution is to delete the comments in ",(0,t.jsx)(n.code,{children:"config.json"})," and re-run the ",(0,t.jsx)(n.code,{children:"gaianet init"})," command."]}),"\n",(0,t.jsx)(n.h2,{id:"the-too-many-open-files-error-on-macos",children:'The "Too many open files" Error on macOS'}),"\n",(0,t.jsxs)(n.p,{children:["When running ",(0,t.jsx)(n.code,{children:"gaianet init"})," to initialize a new node on macOS, you may encounter an error related to snapshot recovery if your snapshot contains a large amount of text. The error message may be the following:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:' * [Error] Failed to recover from the collection snapshot. {"status":{"error":"Service internal error: Too many open files (os error 24)"},"time":1.574064833}\n    * [Error] Failed to recover from the collection snapshot. {"status":{"error":"Service internal error: Too many open files (os error 24)"},"time":1.574064833}\n'})}),"\n",(0,t.jsx)(n.p,{children:"This issue is caused by the default file descriptor (FD) limit on macOS, which is set to a relatively low value of 256."}),"\n",(0,t.jsx)(n.p,{children:"To resolve this issue, you can increase the default FD limit on your system. To do so, run the following command:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"ulimit -n 10000\n"})}),"\n",(0,t.jsxs)(n.p,{children:["This will temporarily set the FD limit to 10,000. Next, use ",(0,t.jsx)(n.code,{children:"gaianet init"})," and ",(0,t.jsx)(n.code,{children:"gaianet start"})," commands in the SAME terminal."]}),"\n",(0,t.jsx)(n.h2,{id:"permission-denied-when-use-the-installer-script-to-install-wasmedge",children:"Permission denied when use the installer script to install WasmEdge"}),"\n",(0,t.jsxs)(n.p,{children:["When running ",(0,t.jsx)(n.code,{children:"curl -sSfL 'https://github.com/GaiaNet-AI/gaianet-node/releases/latest/download/install.sh' | bash"})," to install GaiaNet node software, you may meet the permission denied error especially installing the WasmEdge runtime."]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{src:i(3076).A+"",width:"2114",height:"1126"})}),"\n",(0,t.jsxs)(n.p,{children:["This error is caused by the lack of ",(0,t.jsx)(n.code,{children:"/tmp"})," write permission. You can use ",(0,t.jsx)(n.code,{children:"--tmpdir"})," to specify where you want to install the WasmEdge runtime. Please note, you will need to have written permission to the ",(0,t.jsx)(n.code,{children:"<YOUR_PATH>"})," folder."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"curl -sSfL 'https://github.com/GaiaNet-AI/gaianet-node/releases/latest/download/install.sh' | bash -s -- --tmpdir YOUR_PATH\n"})}),"\n",(0,t.jsxs)(n.p,{children:["This problem is fixed in ",(0,t.jsx)(n.code,{children:"version 0.2.3"}),"."]})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(c,{...e})}):c(e)}},9019:(e,n,i)=>{i.d(n,{A:()=>o});const o=i.p+"assets/images/disable_autoMemoryReclaim_wsl-af7a70038bb2a972c29c0e1b2bc44cf8.png"},3076:(e,n,i)=>{i.d(n,{A:()=>o});const o=i.p+"assets/images/troubleshooting-01-38a832c2c9b16055602256ce4af65948.png"},8453:(e,n,i)=>{i.d(n,{R:()=>s,x:()=>l});var o=i(6540);const t={},r=o.createContext(t);function s(e){const n=o.useContext(r);return o.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:s(e.components),o.createElement(r.Provider,{value:n},e.children)}}}]);